@{
  ViewData["Title"] = "Avatar App";
}
<!DOCTYPE html>
<html lang="en" class="h-100">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PPT Tech Test</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>

<body class="d-flex h-100 text-center text-bg-dark">

  <div class="d-flex w-100 h-100 p-3 mx-auto flex-column">
    <header class="mb-auto">
      <div>
        <h3 class="float-md-start mb-0">Pacific Programming and Tech</h3>
      </div>
    </header>

    <main class="px-3">
      <h1>Technical Test.</h1>
      <p>Change the user identifier to get their profile image</p>
      <div class="d-flex justify-content-center pb-3">
        <input type="text" class="form-control w-auto mx-2" id="userIdentifierInput" placeholder="User identifier">
        <button type="submit" class="btn btn-sm fw-bold border-white bg-white text-black mx-2"
          onclick="onButtonClick()">Get profile image</button>
      </div>
      <div>
        <img src="https://api.dicebear.com/8.x/pixel-art/png?size=150" id="userAvatarImage"
          class="rounded border border-4 border-secondary" />
      </div>
    </main>

    <footer class="mt-auto text-white-50">
      <p>Send completed submissions to backend-tech-test@dblexchange.com</p>
    </footer>
  </div>

  <script type="text/javascript">
    async function onButtonClick() {
      const userIdentifier = document.getElementById('userIdentifierInput').value.trim();
      try {
        const response = await fetch(`/Avatar/GetAvatar?userIdentifier=${encodeURIComponent(userIdentifier)}`);

        if (!response.ok) {
          throw new Error(`Error: ${response.status} - ${response.statusText}`);
        }

        const responseBody = await response.json();
        document.getElementById('userAvatarImage').src = responseBody.url;
      } catch (error) {
        console.error('Error fetching the avatar:', error);
        alert('There was an error fetching the profile image.');
      }
    }

    document.getElementById('userIdentifierInput').addEventListener('keypress', function (event) {
        if (event.key === 'Enter') {
            event.preventDefault(); 
            onButtonClick(); 
        }
    });
  </script>
</body>

</html>